<div class="container">

  <p-toast />

  <div class="titulo align-items-center mb-4">
    <h1>Gestão Eletrônica de Serviços | Vigências</h1>
  </div>

  <!--
  <div class="temas align-items-center mb-4">
    <a (click)="changeTheme('saga-blue')" class="mr-3 cursos-pointer">
      <p-button label="saga-blue" [link]="true" />
    </a>
    <a (click)="changeTheme('vela-blue')" class="mr-3 cursos-pointer">
      <p-button label="vela-blue" [link]="true" />
    </a>
    <a (click)="changeTheme('arya-blue')" class="mr-3 cursos-pointer">
      <p-button label="arya-blue" [link]="true" />
    </a>
    <a (click)="changeTheme('md-light-indigo')" class="mr-3 cursos-pointer">
      <p-button label="md-light-indigo" [link]="true" />
    </a>
    <a (click)="changeTheme('md-dark-indigo')" class="mr-3 cursos-pointer">
      <p-button label="md-dark-indigo" [link]="true" />
    </a>
    <a (click)="changeTheme('bootstrap4-light-purple')" class="mr-3 cursos-pointer">
      <p-button label="bootstrap4-light-purple" [link]="true" />
    </a>
    <a (click)="changeTheme('bootstrap4-dark-purple')" class="mr-3 cursos-pointer">
      <p-button label="bootstrap4-dark-purple" [link]="true" />
    </a>
  </div>
  -->

  <div class="card-R flex justify-content-center">

    <div class="graf">
      <p-knob [(ngModel)]="ativos" [readonly]="true" valueColor="SlateGray" rangeColor="MediumTurquoise" />
      <span>ativos</span>
    </div>

    <div class="graf">
      <p-knob [(ngModel)]="vigencia0a30" [readonly]="true" valueColor="SlateGray" rangeColor="MediumTurquoise" />
      <span>0 até 30</span>
    </div>

    <div class="graf">
      <p-knob [(ngModel)]="vigencia31a60" [readonly]="true" valueColor="SlateGray" rangeColor="MediumTurquoise" />
      <span>31 até 60</span>
    </div>

    <div class="graf">
      <p-knob [(ngModel)]="vigencia61a90" [readonly]="true" valueColor="SlateGray" rangeColor="MediumTurquoise" />
      <span>61 até 90</span>
    </div>

    <div class="graf">
      <p-knob [(ngModel)]="vigenciamaior90" [readonly]="true" valueColor="SlateGray" rangeColor="MediumTurquoise" />
      <span> maior que 90</span>
    </div>

    <div class="graf">
      <p-knob [(ngModel)]="inativos" [readonly]="true" valueColor="SlateGray" rangeColor="MediumTurquoise" />
      <span> inativos</span>
    </div>

  </div>



  <div class="card-C">

    <p-toolbar styleClass="mb-4 gap-2">
      <ng-template pTemplate="left">
        <div>
          <p-button
              severity="success"
              label="Novo"
              icon="pi pi-plus"
              class="mr-2"
              (onClick)="NovoRegistro()"
              />
        </div>
        <div>
        <p-button
              severity="danger"
              label="Excluir"
              icon="pi pi-trash"
              (onClick)="deleteSelectedPosTags()"
              [disabled]="!selectedTags || !selectedTags.length"
              />
        </div>
      </ng-template>
    </p-toolbar>


    <p-table [value]="postags"
      [tableStyle]="{ 'min-width': '50rem' }"
      [paginator]="true"
      [rows]="6"
      [rowsPerPageOptions]="[6, 18, 36]"

      [globalFilterFields]="['descricao', 'categoria', 'vigencia', 'Diasvigencia', 'status']"
      [(selection)]="selectedTags"
      [rowHover]="true"
      dataKey="iDTag"
      currentPageReportTemplate="Exibindo {first} a {last} de {totalRecords} registros"
      [showCurrentPageReport]="true"
      >

      <!--
      <ng-template pTemplate="caption">
        <div class="flex align-items-center justify-content-between">
            <h5 class="m-0">Localizando Serviços</h5>
            <span class="p-input-icon-left">
                <i class="pi pi-search"></i>
                <input
                    pInputText
                    type="text"
                    (input)="dt.filterGlobal($event.target.value, 'contains')"
                    placeholder="Localizar..." />
            </span>
        </div>
      </ng-template>
      -->

      <ng-template pTemplate="header">
          <tr>
              <th style="width: 4rem">
                <p-tableHeaderCheckbox />
              </th>
              <th pSortableColumn="iDTag" style="min-width:15rem">Id <p-sortIcon field="iDTag" /> </th>
              <th pSortableColumn="descricao" style="min-width:15rem">Descrição <p-sortIcon field="descricao" /> </th>
              <th pSortableColumn="categoria" style="min-width:15rem">Categoria <p-sortIcon field="categoria" /> </th>
              <th pSortableColumn="vigencia" style="min-width:15rem">Expira em <p-sortIcon field="vigencia" /> </th>
              <th pSortableColumn="Diasvigencia" style="min-width:15rem">Dias de Vigencia <p-sortIcon field="Diasvigencia" /></th>
              <th pSortableColumn="status" style="min-width:15rem">Status <p-sortIcon field="status" /> </th>
              <th></th>
              <th></th>
              <th></th>
           </tr>
      </ng-template>

      <ng-template pTemplate="body" let-postags>

          <tr [ngClass]="{'row-status': postags.status === 0}">
              <td>
                <p-tableCheckbox [value]="postags" />
              </td>
              <td>{{ postags.iDTag }}</td>
              <td>{{ postags.descricao }}</td>
              <td>{{ postags.categoria }}</td>
              <!--
              <td>
                <div [ngClass]="{'outofstock': postags.categoria === 'Contrato', 'lowstock': postags.categoria === 'Dominio', 'instock': postags.categoria ==='Licenciamento' }"]>
                  {{postags.categoria}}
                </div>
              </td>
              -->
              <td>{{ postags.vigencia }}</td>
              <td>{{ postags.Diasvigencia}}</td>

              <!--
              <td>
                <p-tag [value]="postags.status" [severity]="getSeverity(postags.status)" />
              </td>
              -->

              <td>{{ postags.status}}</td>

              <td>
                <p-button

                    icon="pi pi-info-circle"
                    class="mr-2"
                    [rounded]="true"
                    [outlined]="true"
                    severity="info"
                    (onClick)="viewerPostTags(postags.IDTag)"
                     />
              </td>

              <td>
                <p-button

                    icon="pi pi-pencil"
                    class="mr-2"
                    [rounded]="true"
                    [outlined]="true"
                    severity="success"
                    (onClick)="EditarRegistro(postags.IDTag)"
                     />
              </td>
              <td>
                <p-button

                    icon="pi pi-trash"
                    severity="danger"
                    [rounded]="true"
                    [outlined]="true"
                    (onClick)="deletePosTag(postags.iDTag)"
                     />
              </td>
          </tr>
      </ng-template>

      <ng-template pTemplate="summary">
        <div class="flex align-items-center justify-content-between">
            Total de {{ postags ? postags.length : 0 }} registros.
        </div>
    </ng-template>

    </p-table>
  </div>

  <p-dialog
        [(visible)]="tagDialog"
        [style]="{ width: '450px' }"
        header="Detalhes do Serviço"
        [modal]="true"
        styleClass="p-fluid">
            <ng-template pTemplate="content">

              <p-card styleClass="formulario" class="flex justify-content-center">

                <form [formGroup]="frmTags" novalidate>

                  <td>
                    <img
                        [src]="'https://th.bing.com/th/id/OIP.pQyIgeAD4YQWnAZNYAr0tgHaGs?rs=1&pid=ImgDetMain'"
                        width="50"
                        class="shadow-4" />
                  </td>

                  <div class="field">
                    <label for="descricao" class="block">Descrição do Serviço</label>
                    <input type="text" pInputText placeholder="Desrição do Serviço" formControlName="descricao" />
                    <small class="p-error block" *ngIf="
                        frmTags.get('descricao')?.invalid && frmTags.get('descricao')?.dirty
                      ">
                     Preenchimento Obrigatório.</small>
                  </div>

                  <div class="field">
                    <label for="infor" class="block">Informações</label>
                    <textarea type="textarea" [rows]="10" [cols]=50 pInputTextarea placeholder="Detalhes do Serviço" formControlName="infor" ></textarea>
                    <small class="p-error block" *ngIf="
                        frmTags.get('infor')?.invalid && frmTags.get('infor')?.dirty
                      ">
                      Preenchimento Obrigatório.</small>
                  </div>

                </form>
              </p-card>


              <!--
              <form [formGroup]="frmTags" class="flex flex-column align-items-center gap-3">

                <div class="field">

                  <td>
                    <img
                        [src]="'https://th.bing.com/th/id/OIP.pQyIgeAD4YQWnAZNYAr0tgHaGs?rs=1&pid=ImgDetMain'"
                        width="50"
                        class="shadow-4" />
                  </td>

                  <label for="descricao">Descricao</label>
                  <input
                      type="text"
                      pInputText
                      id="descricao"
                      [(ngModel)]="tagservico.descicao"
                      required
                      autofocus />
                  <small class="p-error" *ngIf="submitted && !tagservico.descicao">
                      campo obrigatório!, informe a descrição do serviço.
                  </small>
              </div>

              <div class="field">
                <label for="infor">Informações</label>
                <textarea
                    id="infor"
                    pInputTextarea
                    [(ngModel)]="tagservico.infor"
                    required
                    rows="10"
                    cols="20">
                </textarea>
              </div>

              <div class="field">
                <label for="categoria">Categoria</label>
                <p-dropdown
                  formControlName="selectedCity"
                  optionLabel="name"
                  placeholder="Select a City" />
              </div>

              </form>
            -->

            </ng-template>

            <ng-template pTemplate="footer">
              <p-button
                  label="Cancelar"
                  icon="pi pi-times"
                  [text]="true"
                  (onClick)="hideDialog()" />
              <p-button
                  label="Gravar"
                  icon="pi pi-check"
                  [text]="true"
                  (onClick)="gravaRegistro(iD)" />
            </ng-template>

  </p-dialog>

  <p-confirmDialog [style]="{ width: '450px' }">



